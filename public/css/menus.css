/***********************************************************
 *  CYTOGRAPHDB – MENUS STYLE (compat hover + JS)
 *  Drop-in fix pour menus et sous-menus
 ***********************************************************/

/* --- Structure de base --- */
.menu-wrapper {
  position: relative;
  display: inline-block;
  z-index: 10; /* au-dessus du graphe */
}

.menu-trigger {
  cursor: pointer;
  padding: 4px 8px;
  border-radius: 3px;
  background-color: #e7edf3;
  border: 1px solid #c8d2dc;
  color: #1f4560;
  font-size: 0.9em;
  user-select: none;
}

.menu-trigger:hover {
  background-color: #d7e7f7;
  border-color: #a8c0d8;
}

/* --- Menus / sous-menus : cachés par défaut --- */
ul.menu,
ul.submenu {
  display: none;
  position: absolute;
  top: 0;
  left: 100%;
  background: #fff;
  border: 1px solid #ccc;
  border-radius: 4px;
  padding: 4px;
  margin: 0;
  box-shadow: 2px 2px 8px rgba(0,0,0,0.15);
  z-index: 3100;
  white-space: nowrap;

}

ul.submenu li {
  position: relative;  /* ancre locale */
}

ul.submenu li > ul.submenu {
  top: 0;
  left: 100%;
}





/* --- Affichage par HOVER (compat ancien comportement) --- */
.menu-wrapper:hover > ul.menu { display: block; }
ul.menu li:hover > ul.submenu { display: block; }

/* --- Affichage piloté par JS (classe ou inline style) --- */
ul.menu.visible,
ul.submenu.visible,
.menu-visible { display: block !important; }

/* NB: si ton JS fait element.style.display="block", l'inline gagne aussi. */

ul.menu li,
ul.submenu li {
  padding: 5px 12px;
  cursor: pointer;
  white-space: nowrap;
  display: flex;
  align-items: center;
  gap: 6px;
}

ul.menu li:hover,
ul.submenu li:hover {
  background-color: #eaf3fa;
}

/* Sous-menu à droite */
ul.submenu { top: 0; left: 100%; }

/* --- Correction : sous-menus alignés sur leur ligne parent --- */
ul.menu > li {
  position: relative; /* sert de référence verticale à son sous-menu */
}

ul.menu > li > ul.submenu {
  top: 0;
  left: 100%;
  transform: translateY(-5px); /* léger décalage pour séparer visuellement */
}

/* pour éviter que les deux sous-menus restent ouverts simultanément */
ul.menu > li:not(:hover) > ul.submenu {
  display: none;
}

/* --- Sous-menus "follow & show" : centrage et encadré --- */
li[data-category="follow"] > ul.submenu {
  display: flex;                 /* pour centrer horizontalement */
  flex-direction: column;        /* les SVG l’un au-dessus de l’autre */
  align-items: center;           /* centre horizontalement les SVG */
  justify-content: center;
  gap: -2px;                      /* petit espace entre les lignes */
  padding: 2px;
  border: 1px solid #aab;        /* encadré global */
  border-radius: 6px;
  background-color: #fff;
  box-shadow: 1px 2px 6px rgba(0,0,0,0.1);
  min-width: 160px;
}

/* chaque ligne (li) avec SVG : encadré léger et centrage interne */
li[data-category="follow"] > ul.submenu > li {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 2px;
  border: 1px solid #ccd;
  border-radius: 2px;
  background-color: #f8fafc;
  transition: background-color 0.15s, transform 0.1s;
}

li[data-category="follow"] > ul.submenu > li:hover {
  background-color: #eaf3fa;
  transform: scale(1.06);
}


/* --- Corrige le comportement des séparateurs dans les sous-menus --- */
.menu .separator,
.submenu .separator {
  display: block;
  width: calc(100% - 22px);      /* réduit un peu la largeur pour compenser les paddings */
  margin: 4px auto;              /* centre horizontalement */
  border-top: 1px solid var(--border-color, #bbb);
  pointer-events: none;          /* pas de hover */
  background: transparent;
  line-height: 0;
}




/* --- Variantes visuelles par type de menu (conserve tes couleurs) --- */
[data-menu-id="menu-db"] .menu-trigger { background-color: #e0f0ff; }
[data-menu-id="menu-graph"] .menu-trigger { background-color: #f4faff; }
[data-menu-id="menu-display"] .menu-trigger { background-color: #f5faff; }
[data-menu-id="menu-nodes"] .menu-trigger { background-color: #f8fdf8; }
[data-menu-id="menu-edges"] .menu-trigger { background-color: #fdfaf8; }
[data-menu-id="menu-model"] .menu-trigger { background-color: #f9f6ff; }
[data-menu-id] .menu-trigger:hover { filter: brightness(0.95); }

/* --- Boîte de connexion DB (prompt) --- */
.db-box-container {
  position: absolute;
  top: 100%;
  left: 0;
  background: #f9fcff;
  border: 1px solid #c8d2dc;
  border-radius: 5px;
  padding: 6px 8px;
  min-width: 220px;
  z-index: 1600;
  display: none;           /* cachée par défaut */
}

/* visible → contrôlé par ton JS */
.db-box-container.visible { display: block; }

.db-prompt-select {
  margin: 3px 0;
  padding: 3px 5px;
  border: 1px solid #ccc;
  border-radius: 3px;
  background-color: #fff;
}
.db-prompt-select:hover { border-color: #98b1c9; }

/* --- Barre d’outils (2e ligne) --- */
#graph-controls.layout {
  display: flex;
  align-items: center;
  background-color: #eaf2f8;
  border-top: 1px solid #d0d7de;
  gap: 8px;
  padding: 0 10px;
  height: 40px;
  z-index: 100;
}

#graph-controls select,
#graph-controls button { font-size: 0.85em; }
#graph-controls button img { vertical-align: middle; }

/* --- Icônes d’actions / menus rapides --- */
.icon-actions {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 4px;
}
.icon-actions img,
#quickAccessMenu img {
  cursor: pointer;
  width: 40px;
  height: 40px;
  border-radius: 3px;
  border: 1px solid transparent;
}
.icon-actions img:hover,
#quickAccessMenu img:hover {
  background-color: #d7e7f7;
  border-color: #aac6e3;
}


#menu-nodes #icon-selectAll:hover { content: url("/img/select/selectAllBright.png"); }
#menu-nodes #icon-selectNone:hover { content: url("/img/select/noneSelected.png"); }
#menu-nodes #icon-selectSwap:hover { content: url("/img/select/swapSelected.png"); }

/* idem pour hide/show si tu les utilises */
#menu-nodes #icon-hideSelected:hover   { content: url("/img/select/hideSelected.png"); }
#menu-nodes #icon-hideNotSelected:hover{ content: url("/img/select/hideNotSelected.png"); }
#menu-nodes #icon-swapHidden:hover     { content: url("/img/select/hideSwap2.png"); }
#menu-nodes #icon-showAll:hover        { content: url("/img/select/halfSelected.png"); }






/* --- Comment icon --- */
.comment-icon {
  display: inline-block;
  width: 16px; height: 16px;
  /*background-image: url("/img/info-icon.png");*/
  background-size: contain;
  background-repeat: no-repeat;
  margin-left: 4px;
  vertical-align: middle;
  opacity: .7;
}
.comment-icon:hover { opacity: 1; }

/* --- Responsive --- */
@media (max-width: 1000px) {
  #graph-controls.layout { flex-wrap: wrap; height: auto; }
  .menu-trigger { font-size: .8em; padding: 3px 6px; }
  ul.menu li, ul.submenu li { padding: 4px 8px; }
}

/* --- Assure que les dropdowns de la 1ère ligne passent au-dessus de la 2e --- */
#topbar { position: relative; z-index: 100; }           /* contexte global */
.loadGraphOptions { position: relative; z-index: 2000; } /* ligne 1 (DB/Files) au-dessus */
#graph-controls.layout { position: relative; z-index: 100; } /* ligne 2 en-dessous */

.menu-wrapper { position: relative; z-index: 2100; }     /* chaque trigger au-dessus */
ul.menu, ul.submenu, .db-box-container {
  position: absolute;
  z-index: 3000;        /* les menus passent au-dessus de tout le topbar */
  top: calc(100% + 2px); /* petit décalage visuel sous le trigger */
  left: 0;
}


/* --- Réglage du positionnement vertical / horizontal --- */

/* Menus principaux (DB, Files, Display, Tables, etc.) */
ul.menu {
  top: calc(100% + 2px); /* s’ouvre vers le bas sous le trigger */
  left: 0;
  z-index: 3000;
}

/* Sous-menus (ceux qui doivent s’ouvrir à droite du parent) */
ul.submenu {
  top: 0;                /* aligné verticalement avec le parent */
  left: 100%;            /* décalé à droite */
  z-index: 3100;         /* au-dessus du parent */
}

/* --- Correction profondeur des sous-menus --- */
ul.menu li:hover > ul.submenu,
ul.submenu li:hover > ul.submenu {
  display: block;
}

/* Décalage horizontal des sous-menus */
ul.submenu {
  top: 0;
  left: 100%;
  margin-left: 2px;
}

/* Évite qu’un sous-menu long dépasse l’écran */
ul.submenu ul.submenu {
  left: 100%;
  top: 0;
  z-index: 3200;
}
